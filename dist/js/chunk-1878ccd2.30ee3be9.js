(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1878ccd2","chunk-2d0c04f1"],{"025d":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Container",{attrs:{type:"card-full",scorll:!1}},[i("div",{staticClass:"dd-title"},[e._v("Script")]),i("div",{staticClass:"row"},[i("ScriptTypeSelect",{on:{delete:e.init},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}}),i("el-button",{staticClass:"dd-fr",attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("submit")])],1),i("el-table",{staticClass:"scriptTable",attrs:{height:"500",data:e.scriptData,border:""}},[i("el-table-column",{attrs:{label:"stmt","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:t.row.stmt,callback:function(i){e.$set(t.row,"stmt",i)},expression:"scope.row.stmt"}},e._l(e.scriptList,(function(e){return i("el-option",{key:e.val,attrs:{label:e.val,value:e.val}})})),1)]}}])}),i("el-table-column",{attrs:{label:"expr","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{ref:"input-"+t.$index,attrs:{placeholder:""},nativeOn:{keyup:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.add(t.$index)},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"up",38,i.key,["Up","ArrowUp"])?null:e.moveUp(t.$index)},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"down",40,i.key,["Down","ArrowDown"])?null:e.moveDown(t.$index)}]},model:{value:t.row.expr,callback:function(i){e.$set(t.row,"expr",i)},expression:"scope.row.expr"}})]}}])})],1)],1)},n=[],s=(i("7f7f"),i("7de8")),r=i("f121"),a=i("40dc"),u={mixins:[s["a"]],data:function(){return{scriptData:[],scriptList:r["e"],type:{name:"",subr:""}}},methods:{init:function(){this.scriptData=[];var e=10;while(e--)this.scriptData.push({stmt:"",expr:""})},readSubroutine:function(e){this.$ws().set({success:this.getData}).send({func:33,subr:+e})},getData:function(e){33===e.func&&(this.$ws().remove(this.getData),e.rows?0===e.rows.length?this.init():this.scriptData=e.rows:this.init())},handleSubmit:function(){if(this.type.subr){var e=this.scriptData,t=this.type,i=t.name,l=t.subr;this.$ws().set().send({func:34,csub:0,name:i,subr:+l,nrow:e.length,rows:e})}else this.$message.error("选择")},add:function(e){e===this.scriptData.length-1&&this.scriptData.push({stmt:"",expr:""})},moveUp:function(e){e>0&&this.$refs["input-"+(e-1)].focus()},moveDown:function(e){e<this.scriptData.length-1&&this.$refs["input-"+(e+1)].focus()}},watch:{"type.subr":function(e){e&&this.readSubroutine(e)}},components:{ScriptTypeSelect:a["default"]}},o=u,c=(i("0e8f"),i("2877")),b=Object(c["a"])(o,l,n,!1,null,"4bb3c342",null);t["default"]=b.exports},"0e8f":function(e,t,i){"use strict";var l=i("8359"),n=i.n(l);n.a},"28a5":function(e,t,i){"use strict";var l=i("aae3"),n=i("cb7c"),s=i("ebd6"),r=i("0390"),a=i("9def"),u=i("5f1b"),o=i("520a"),c=i("79e5"),b=Math.min,d=[].push,p="split",f="length",h="lastIndex",v=4294967295,m=!c((function(){RegExp(v,"y")}));i("214f")("split",2,(function(e,t,i,c){var y;return y="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[f]||2!="ab"[p](/(?:ab)*/)[f]||4!="."[p](/(.?)(.?)/)[f]||"."[p](/()()/)[f]>1||""[p](/.?/)[f]?function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!l(e))return i.call(n,e,t);var s,r,a,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),b=0,p=void 0===t?v:t>>>0,m=new RegExp(e.source,c+"g");while(s=o.call(m,n)){if(r=m[h],r>b&&(u.push(n.slice(b,s.index)),s[f]>1&&s.index<n[f]&&d.apply(u,s.slice(1)),a=s[0][f],b=r,u[f]>=p))break;m[h]===s.index&&m[h]++}return b===n[f]?!a&&m.test("")||u.push(""):u.push(n.slice(b)),u[f]>p?u.slice(0,p):u}:"0"[p](void 0,0)[f]?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,l){var n=e(this),s=void 0==i?void 0:i[t];return void 0!==s?s.call(i,n,l):y.call(String(n),i,l)},function(e,t){var l=c(y,e,this,t,y!==i);if(l.done)return l.value;var o=n(e),d=String(this),p=s(o,RegExp),f=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(m?"y":"g"),w=new p(m?o:"^(?:"+o.source+")",h),S=void 0===t?v:t>>>0;if(0===S)return[];if(0===d.length)return null===u(w,d)?[d]:[];var k=0,g=0,x=[];while(g<d.length){w.lastIndex=m?g:0;var T,E=u(w,m?d:d.slice(g));if(null===E||(T=b(a(w.lastIndex+(m?0:g)),d.length))===k)g=r(d,g,f);else{if(x.push(d.slice(k,g)),x.length===S)return x;for(var F=1;F<=E.length-1;F++)if(x.push(E[F]),x.length===S)return x;g=k=T}}return x.push(d.slice(k)),x}]}))},"40dc":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{display:"inline-block"}},[i("el-select",{attrs:{placeholder:""},on:{change:e.handleSelect},model:{value:e.scriptType.subr,callback:function(t){e.$set(e.scriptType,"subr",t)},expression:"scriptType.subr"}},e._l(e.scriptTypeList,(function(e){return i("el-option",{key:e.subr,attrs:{label:e.name,value:e.subr}})})),1),e._v("\n    \n  "),i("el-button",{attrs:{type:"danger"},on:{click:e.handleDelete}},[e._v("delete")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("create")]),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible},on:{closed:e.handleClose,"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"subroutineForm",attrs:{model:e.subroutineForm,rules:e.subroutineFormRules,"label-width":"100px"}},[i("el-form-item",{attrs:{prop:"name",label:"name"}},[i("el-input",{model:{value:e.subroutineForm.name,callback:function(t){e.$set(e.subroutineForm,"name",t)},expression:"subroutineForm.name"}})],1),i("el-form-item",{attrs:{prop:"subr",label:"subr"}},[i("el-input",{model:{value:e.subroutineForm.subr,callback:function(t){e.$set(e.subroutineForm,"subr",t)},expression:"subroutineForm.subr"}})],1)],1),i("template",{slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],2)],1)},n=[],s=(i("7f7f"),i("6762"),i("75fc")),r={props:["value"],data:function(){return{scriptType:null,scriptTypeList:[{name:"Main",subr:-10},{name:"Auto",subr:-20},{name:"Manual",subr:-30}],dialogVisible:!1,subroutineForm:{name:"",subr:""},subroutineFormRules:{name:[{required:!0,message:"",trigger:"blur"}],subr:[{required:!0,message:"",trigger:"blur"}]}}},beforeMount:function(){this.init()},methods:{init:function(){this.$ws().set({success:this.setSubroutineList}).send({func:32})},setSubroutineList:function(e){var t;32===e.func&&(this.$ws().remove(this.setSubroutineList),(t=this.scriptTypeList).unshift.apply(t,Object(s["a"])(e.rows)))},handleCreate:function(){this.dialogVisible=!0},handleDelete:function(){var e=this,t=[-10,-20,-30];if(this.scriptType.subr&&!t.includes(this.scriptType.subr)){this.$ws().send({func:35,subr:this.scriptType.subr});var i=this.scriptTypeList.filter((function(i){return t.includes(i.subr)||i.subr!==e.scriptType.subr}));i.length!==this.scriptTypeList.length&&(this.scriptTypeList=i,this.scriptType={name:"",subr:""}),this.$emit("delete")}},handleClose:function(){this.$refs.subroutineForm.resetFields(),this.subroutineForm={name:"",subr:""}},handleSubmit:function(){var e=this;this.$refs.subroutineForm.validate((function(t){if(!t)return!1;var i=e.subroutineForm,l=i.name,n=i.subr;e.scriptTypeList.some((function(e){return e.subr===n}))||(e.scriptTypeList.push({name:l,subr:n}),e.dialogVisible=!1)}))},handleSelect:function(e){if(e){var t=this.scriptTypeList.filter((function(t){return t.subr===e}));this.scriptType={name:t[0].name,subr:t[0].subr},this.$emit("input",this.scriptType)}}},watch:{value:{handler:function(e){this.scriptType=e},immediate:!0}}},a=r,u=i("2877"),o=Object(u["a"])(a,l,n,!1,null,"177a8f34",null);t["default"]=o.exports},"7de8":function(e,t,i){"use strict";i("7f7f"),i("28a5");t["a"]={mounted:function(){document.title=this.$route.name.split("-")[0]}}},8359:function(e,t,i){},f121:function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"f",(function(){return n})),i.d(t,"a",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"e",(function(){return u})),i.d(t,"g",(function(){return o}));var l=[{val:"mbstcp",label:"Modbus TCP"},{val:"ethip",label:"Allen - Bradley Ethernet / IP"},{val:"mele71",label:"Mitsubishi MC Protocol for MELSEC - Q and E71 module"},{val:"finstc",label:"Omron FINS on TCP"},{val:"s7iso",label:"Siemens Industrial Ethernet ISO for S7 - 300 / 400"},{val:"siefw",label:"Siemens Fetch Write for S7 - 300 / 400 and CP443 module"},{val:"tsxmbt",label:"Schneider Modbus TCP"}],n=[{val:"mbsrtu",label:"Modbus RTU"},{val:"df1hp2",label:"Allen - Bradley DF1 half - duplex for PLC2"},{val:"df1hp5",label:"Allen - Bradley DF1 half - duplex for PLC5"},{val:"fxnpro",label:"Mitsubishi FX0N / FX0S / FX1N / FX1S / FX2"},{val:"fxdpro",label:"Mitsubishi FX 232ADP / 485BD / 232BD Module"},{val:"fx3u3g",label:"Mitsubishi FX2N / FX3U / FX3G / FX3S"},{val:"melc24",label:"Mitsubishi MC Protocol full - duplex for MELSEC - Q and C24 module"},{val:"finshl",label:"Omron FINS on Host Link"},{val:"omrhls",label:"Omron Host Link(single)"},{val:"omrhlm",label:"Omron Host Link(multiple)"},{val:"s539rk",label:"Siemens 3964R / RK512 for S5"},{val:"s739rk",label:"Siemens 3964R / RK512 for S7"},{val:"tsxmbr",label:"Schneider Modbus RTU"},{val:"unite",label:"Schneider Telemecanique UNI - TE"},{val:"comli",label:"ABB SattControl Comli"}],s=[{val:"word"},{val:"uword"},{val:"dword"},{val:"udword"},{val:"float"},{val:"double"},{val:"bit"}],r=[{val:">"},{val:">="},{val:"=="},{val:"<"},{val:"<="},{val:"!="},{val:"&"},{val:"^"},{val:"|"}],a=[{val:"critical"},{val:"alarm"},{val:"warning"},{val:"event"},{val:"view"}],u=[{val:"COMMENT"},{val:"DECLARE"},{val:"INIT"},{val:"DO"},{val:"IF"},{val:"THEN"},{val:"ELSE IF"},{val:"ELSE"},{val:"POS"}],o=[{label:"VIEW(0)",key:0},{label:"OPERATOR(1)",key:1},{label:"FOREMAN(2)",key:2},{label:"MAINENANCE(3)",key:3},{label:"SUPERVISOR(4)",key:4},{label:"ENGINEER(5)",key:5},{label:"DESIGNER(6)",key:6},{label:"MANAGER(7)",key:7}]}}]);
//# sourceMappingURL=chunk-1878ccd2.30ee3be9.js.map